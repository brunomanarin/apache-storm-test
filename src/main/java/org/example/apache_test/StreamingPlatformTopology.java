package org.example.apache_test;

import java.io.File;

import org.apache.storm.Config;
import org.apache.storm.LocalCluster;
import org.apache.storm.topology.TopologyBuilder;

public class StreamingPlatformTopology {
    private static final String inputPath = new File("C:\\Users\\bruno\\OneDrive\\Área de Trabalho\\tv_shows.csv").getAbsolutePath();
    private static final String outputPath = new File("C:\\Users\\bruno\\OneDrive\\Área de Trabalho\\output.txt").getAbsolutePath();

    
 public static void main(String args[]) {
  System.out.println("----------------------------------------------------------");

  System.out.println("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    %%   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@    %%%%    @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  %%,% %%   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  %#%%% % #  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@   ........@   @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@     @                 .......                 @@   @@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@  ###     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@  @  ##  @@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@     (##.     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@  @  ##  (@@@ @@@@@@@\r\n" + 
  		"@@@@@@@@ ####     #.# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@      #    #  @@@@@@@\r\n" + 
  		"@@@@@@     ###/#(###  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@  ###/  (##    @@@@@@\r\n" + 
  		"@@@@@@% ####     ./#  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@          ##/  @@@@@@\r\n" + 
  		"@@@@@@    .#*# ####   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@   #####*###    @@@@@\r\n" + 
  		"@@@@@  ###   #        ....................................@            .   @@@@@\r\n" + 
  		"@@@@@   ##### #####   ...../#.....................,#/.....@   ##*#  (##     @@@@\r\n" + 
  		"@@@@( #.##            ........#####..........##*,.........@  *          (  @@@@@\r\n" + 
  		"@@@@@# #####  #####   ...........####%%%%%###,............@    ###(.#(##  @@@@@@\r\n" + 
  		"@@@@, ###        #/   .......%%%*%%%###.##(..%%%%%%.......@  *     /   ,#  @@@@@\r\n" + 
  		"@@@@@  #####  #(###   ......%/%.%%%%%%%%%%.,%%%%%%%%%%%...@   #### .####  @@@@@@\r\n" + 
  		"@@@@@ # ,*   .  ##(   ...,%%%%....%%%%%%%%%%%(......%%....@  (##            @@@@\r\n" + 
  		"@@@@@@ ##### #####    ..../(%%#%%%...,....*..%%%#%%%%%%#..@   #######,##  @@@@@@\r\n" + 
  		"@@@@@@@ .        ##/  @...../(%%%%.........#..,%%%%%%.....  (##   .        @@@@@\r\n" + 
  		"@@@@@@@& ###/#####      @.....(%%.#............%%%%%...,     .#####.##   @@@@@@@\r\n" + 
  		"@@@@@@@@@      #  ####  @    @.....................@    @  #*#  #        @@@@@@@\r\n" + 
  		"@@@@@@@  ######*###   @@@@@@@@     @.........(    (@@@@@@@@   (, ####.  @@@@@@@@\r\n" + 
  		"@@@@@@@@@@&       #   @@@@@@@@@         @.(  @@@@@@@@@@@@@@   #       @@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@@@@@@@     # %%%%%%%%%%%%%%(  ..@  %%%%%%%%%%%%%%(#      @@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@@@    %%%%/ (    % %%%%%%%%%%%%%%%%%%%%%%%%%%%,%% % %  %%%%%     @@@@@@@@\r\n" + 
  		"@@@@@@@@ *%%  %%%%%%%%          @@%%%%%%%%%%%%&@@         /%%%%%%  *%%%   @@@@@@\r\n" + 
  		"@@,   %%%%%%%%@@@@  @@@@@@@@@@@  ##    ..  @  #   @@@@@@@@@@   %@@@%%%%%%%    ,@\r\n" + 
  		"@@@@@.  #%%%%%    @@@@@@@@@@@@  ##  @@ (.  @@  ##  @@@@@@@@@@@@    %%%%%    @@@@\r\n" + 
  		"@@@@@  %   (@@@@@@@@@@@@@@@@@@  #  @@ (...  @@  #, @@@@@@@@@@@@@@@@@@   %%  @@@@\r\n" + 
  		"@@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@     @@@@ @@@@@@@@@@@@@@@@@@@@@@@@@@@@ @@@\r\n" + 
  		"@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@    @@@@@@@@    @@@@               @@@@@@            @@@@@@@            @@@@\r\n" + 
  		"@@@@    @@@@@@@@    @@@@               @@@            @@@@@@@@@            %@@@@\r\n" + 
  		"@@@@    @@@@@@@@    @@@@    @@@@@@@@@@@@@@     @@@@@@@@@@@@@@@     @@@@@@@@@@@@@@@\r\n" + 
  		"@@@@    @@@@@@@@    @@@@    @@@@@@@@@@@@@@     @@@@@@@@@@@@@     @@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@    @@@@@@@@    @@@@            @@@@@@@@            @@@     @@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@    @@@@@@@@    @@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@@    @@     @@@@@@@@@@@@@@@@\r\n" + 
  		"@@@@@    @@@@@     @@@@@   @@@@@@@@@@@@@@@@@@@@@@@@@@     @@     @@@@@@@@@@@@@@\r\n" + 
  		"@@@@@@@          @@@@@@@   @@@@@@@@@@@@@@              @@@@@@             @@@@");
  
  System.out.println("INE5645-05238 (20202) - Programação Paralela e Distribuída");
  System.out.println("Trabalho final da disciplina.");
  System.out.println("Alunos: Bruno Manarin, Lui Almeida, Rafaela Bernardo, Charlinston");
  System.out.println("----------------------------------------------------------");
  
  TopologyBuilder builder = new TopologyBuilder();
  builder.setSpout("prepare-csv", new StreamingPlatformSpout());
  builder.setBolt("analize-csv", new StreamingPlatformBolt(), 1).shuffleGrouping("prepare-csv");

  // Configuration
  Config config = new Config();
  config.put("inputFile", inputPath);
  config.put("outputFile", outputPath);
  config.setDebug(true);
   
  LocalCluster localCluster = new LocalCluster();
  localCluster.submitTopology("analysis-topology", config, builder.createTopology());
  try {
   Thread.sleep(10000);
   localCluster.shutdown();
  } catch (InterruptedException e) {
   e.printStackTrace();
   localCluster.shutdown();
  }
 }

}